"use strict";var k=Object.defineProperty;var pe=Object.getOwnPropertyDescriptor;var le=Object.getOwnPropertyNames;var me=Object.prototype.hasOwnProperty;var A=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),he=(e,t)=>{for(var r in t)k(e,r,{get:t[r],enumerable:!0})},ye=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of le(t))!me.call(e,o)&&o!==r&&k(e,o,{get:()=>t[o],enumerable:!(n=pe(t,o))||n.enumerable});return e};var de=e=>ye(k({},"__esModule",{value:!0}),e);var W=A((Ve,G)=>{"use strict";var I,s,K={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:`
`,r:"\r",t:"	"},E;function g(e){throw{name:"SyntaxError",message:e,at:I,text:E}}function a(e){return e&&e!==s&&g("Expected '"+e+"' instead of '"+s+"'"),s=E.charAt(I),I+=1,s}function T(){var e,t="";for(s==="-"&&(t="-",a("-"));s>="0"&&s<="9";)t+=s,a();if(s===".")for(t+=".";a()&&s>="0"&&s<="9";)t+=s;if(s==="e"||s==="E")for(t+=s,a(),(s==="-"||s==="+")&&(t+=s,a());s>="0"&&s<="9";)t+=s,a();return e=Number(t),isFinite(e)||g("Bad number"),e}function H(){var e,t,r="",n;if(s==='"')for(;a();){if(s==='"')return a(),r;if(s==="\\")if(a(),s==="u"){for(n=0,t=0;t<4&&(e=parseInt(a(),16),!!isFinite(e));t+=1)n=n*16+e;r+=String.fromCharCode(n)}else if(typeof K[s]=="string")r+=K[s];else break;else r+=s}g("Bad string")}function y(){for(;s&&s<=" ";)a()}function ge(){switch(s){case"t":return a("t"),a("r"),a("u"),a("e"),!0;case"f":return a("f"),a("a"),a("l"),a("s"),a("e"),!1;case"n":return a("n"),a("u"),a("l"),a("l"),null;default:g("Unexpected '"+s+"'")}}function be(){var e=[];if(s==="["){if(a("["),y(),s==="]")return a("]"),e;for(;s;){if(e.push(P()),y(),s==="]")return a("]"),e;a(","),y()}}g("Bad array")}function Oe(){var e,t={};if(s==="{"){if(a("{"),y(),s==="}")return a("}"),t;for(;s;){if(e=H(),y(),a(":"),Object.prototype.hasOwnProperty.call(t,e)&&g('Duplicate key "'+e+'"'),t[e]=P(),y(),s==="}")return a("}"),t;a(","),y()}}g("Bad object")}function P(){switch(y(),s){case"{":return Oe();case"[":return be();case'"':return H();case"-":return T();default:return s>="0"&&s<="9"?T():ge()}}G.exports=function(e,t){var r;return E=e,I=0,s=" ",r=P(),y(),s&&g("Syntax error"),typeof t=="function"?function n(o,f){var p,u,i=o[f];if(i&&typeof i=="object")for(p in P)Object.prototype.hasOwnProperty.call(i,p)&&(u=n(i,p),typeof u>"u"?delete i[p]:i[p]=u);return t.call(o,f,i)}({"":r},""):r}});var L=A((Fe,z)=>{"use strict";var D=/[\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,m,x,ve={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},b;function V(e){return D.lastIndex=0,D.test(e)?'"'+e.replace(D,function(t){var r=ve[t];return typeof r=="string"?r:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function w(e,t){var r,n,o,f,p=m,u,i=t[e];switch(i&&typeof i=="object"&&typeof i.toJSON=="function"&&(i=i.toJSON(e)),typeof b=="function"&&(i=b.call(t,e,i)),typeof i){case"string":return V(i);case"number":return isFinite(i)?String(i):"null";case"boolean":case"null":return String(i);case"object":if(!i)return"null";if(m+=x,u=[],Object.prototype.toString.apply(i)==="[object Array]"){for(f=i.length,r=0;r<f;r+=1)u[r]=w(r,i)||"null";return o=u.length===0?"[]":m?`[
`+m+u.join(`,
`+m)+`
`+p+"]":"["+u.join(",")+"]",m=p,o}if(b&&typeof b=="object")for(f=b.length,r=0;r<f;r+=1)n=b[r],typeof n=="string"&&(o=w(n,i),o&&u.push(V(n)+(m?": ":":")+o));else for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(o=w(n,i),o&&u.push(V(n)+(m?": ":":")+o));return o=u.length===0?"{}":m?`{
`+m+u.join(`,
`+m)+`
`+p+"}":"{"+u.join(",")+"}",m=p,o;default:}}z.exports=function(e,t,r){var n;if(m="",x="",typeof r=="number")for(n=0;n<r;n+=1)x+=" ";else typeof r=="string"&&(x=r);if(b=t,t&&typeof t!="function"&&(typeof t!="object"||typeof t.length!="number"))throw new Error("JSON.stringify");return w("",{"":e})}});var Y=A(F=>{"use strict";F.parse=W();F.stringify=L()});var X=A((Ce,Q)=>{"use strict";var R=typeof JSON<"u"?JSON:Y(),je=Array.isArray||function(e){return{}.toString.call(e)==="[object Array]"},Se=Object.keys||function(e){var t=Object.prototype.hasOwnProperty||function(){return!0},r=[];for(var n in e)t.call(e,n)&&r.push(n);return r};Q.exports=function(e,t){t||(t={}),typeof t=="function"&&(t={cmp:t});var r=t.space||"";typeof r=="number"&&(r=Array(r+1).join(" "));var n=typeof t.cycles=="boolean"?t.cycles:!1,o=t.replacer||function(u,i){return i},f=t.cmp&&function(u){return function(i){return function(l,c){var j={key:l,value:i[l]},v={key:c,value:i[c]};return u(j,v)}}}(t.cmp),p=[];return function u(i,l,c,j){var v=r?`
`+new Array(j+1).join(r):"",ce=r?": ":":";if(c&&c.toJSON&&typeof c.toJSON=="function"&&(c=c.toJSON()),c=o.call(i,l,c),c!==void 0){if(typeof c!="object"||c===null)return R.stringify(c);if(je(c)){for(var S=[],d=0;d<c.length;d++){var ue=u(c,d,c[d],j+1)||R.stringify(null);S.push(v+r+ue)}return"["+S.join(",")+v+"]"}if(p.indexOf(c)!==-1){if(n)return R.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}else p.push(c);for(var C=Se(c).sort(f&&f(c)),S=[],d=0;d<C.length;d++){var l=C[d],J=u(c,l,c[l],j+1);if(!!J){var fe=R.stringify(l)+ce+J;S.push(v+r+fe)}}return p.splice(p.indexOf(c),1),"{"+S.join(",")+v+"}"}}({"":e},"",e,0)}});var _e={};he(_e,{default:()=>Re});module.exports=de(_e);var O=require("@stoplight/spectral-functions"),_=require("@stoplight/spectral-formats"),ae=require("@stoplight/spectral-rulesets");var $;(function(e){e.Simple="simple",e.Matrix="matrix",e.Label="label",e.Form="form",e.CommaDelimited="commaDelimited",e.SpaceDelimited="spaceDelimited",e.PipeDelimited="pipeDelimited",e.DeepObject="deepObject"})($||($={}));var h;(function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Information=2]="Information",e[e.Hint=3]="Hint"})(h||(h={}));var B;(function(e){e.Article="article",e.HttpService="http_service",e.HttpServer="http_server",e.HttpOperation="http_operation",e.Model="model",e.Generic="generic",e.Unknown="unknown",e.TableOfContents="table_of_contents",e.SpectralRuleset="spectral_ruleset",e.Styleguide="styleguide",e.Image="image"})(B||(B={}));var M;(function(e){e.Json="json",e.Markdown="markdown",e.Yaml="yaml",e.Javascript="javascript",e.Apng="apng",e.Avif="avif",e.Bmp="bmp",e.Gif="gif",e.Jpeg="jpeg",e.Png="png",e.Svg="svg",e.Webp="webp"})(M||(M={}));var U=e=>e.length<=1?[]:[{message:"Potential misuse of security has been detected"}];var Z=X(),q=e=>{if(e==null)throw Error("All references should be dereferenced and non-empty");if("$ref"in e)throw Error("All references should be dereferenced by Spectral already");return e},N=(e,t)=>{if(e.length!==t.length)return!1;let r=e.map(o=>Z(o)),n=t.map(o=>Z(o));return r.filter(o=>n.includes(o)).length===r.length},ee=(e,t)=>{e!==null&&te(e,t,[])},te=(e,t,r)=>{e!==null&&Object.entries(e).forEach(([n,o])=>{let f=[...r];f.push(n),t(n,o,f),typeof o=="object"?te(o,t,f):t(n,o,f)})};var re=(e,t,r)=>{let n=[],o=r.document.data,f=o.components?.securitySchemes;if(!f)return[];let p=o.security?o.security:e.security;if(!p)return[];if(!e.parameters)return[];let u=e.parameters.map(i=>q(i).name);return p.flatMap(i=>Object.keys(i).map(l=>{let c=q(f[l]);c.type==="http"&&u.includes("Authorization")?n.push({message:"Authorization"}):c.type==="apiKey"&&u.includes(c.name)&&n.push({message:c.name})})),n};var ne=(e,t,r)=>{let n=[],o=r.document.data;return!o.security||!e.security?[]:(N(o.security,e.security)&&n.push({message:"Detected redundant security schemes."}),n)};var ie=(e,t,r)=>{let n=[],o=r.document.data,f=0,p=0;return ee(o,(u,i,l)=>{typeof i=="object"&&i!==null&&"type"in i&&i.type==="object"&&(l.includes("responses")||l.includes("schemas"))&&(f++,p+=i.additionalProperties?1:0)}),f>0&&p===0&&n.push({message:"Detected potential problem with object types"}),n},se=`No 'additionalProperties: true' detected throughout 
spec. Is your spec is 100% compliant with your production API? If yes 
(CONGRATS!), ignore this rule in .spectral.yaml and move on. If no, ignore this 
rule in .spectral.yaml and configure your konfig.yaml to intelligently attach 
'additionalProperties: true' to response bodies.`;var oe=e=>{let t=[];if(typeof e!="object"||e===null||!("type"in e)||!("example"in e))return[];let r=e.type;if(typeof r!="string")return[];let n=e.example;return t.push(...Ae(r,n)),t},Ae=(e,t)=>e==="string"&&typeof t=="string"?Ie(t):[];function Ie(e){return xe(e)?[{message:"Could be integer type based on example"}]:we(e)?[{message:"Could be number type based on example"}]:Pe(e)?[{message:"Could be boolean type based on example"}]:[]}function Pe(e){return e==="true"||e==="false"}function xe(e){return/^[-+]?\d+$/.test(e)}function we(e){var t=/^-?\d+(?:[.,]\d*?)?$/;if(!t.test(e))return!1;let r=parseFloat(e);return!isNaN(r)}var Re={extends:ae.oas,aliases:{PathItem:["$.paths[*]"],OperationObject:["#PathItem[get,put,post,delete,options,head,patch,trace]"],ParameterSchemaObject:["#OperationObject.parameters.*.schema"],RequestSchemaObject:["#OperationObject.requestBody.content.*.schema"],ResponseSchemaObject:["#OperationObject.responses.*.content.*.schema"]},rules:{"operation-description":"off","operation-success-response":"off","info-contact":"off","no-http-basic":{description:"Consider a more secure alternative to HTTP Basic",message:"HTTP Basic is a pretty insecure way to pass credentials around, please consider an alternative.",given:"$.components.securitySchemes[*]",then:{field:"scheme",function:O.pattern,functionOptions:{notMatch:"basic"}},severity:h.Error},"no-file-extensions-in-paths":{description:"Paths must not include file extensions such as .json, .xml, .html and .txt",message:"Paths must not include file extensions such as .json, .xml, .html and .txt. Use the OpenAPI `content` keyword to tell consumers which Media Types are available.",given:"$.paths[*]~",then:{function:O.pattern,functionOptions:{notMatch:".(json|xml|html|txt)$"}},severity:h.Error},"adv-security-schemes-defined":{description:"All APIs MUST have a security scheme defined.",message:"This API definition does not have any security scheme defined.",given:"$..components",then:{field:"securitySchemes",function:O.truthy},formats:[_.oas3],severity:h.Error},"list-usage-of-security":{description:"List usage of security implies multiple possible security strategies which is uncommon",message:"Potential misuse of the security field. Only use list when you have multiple security strategies. (i.e. list vs map is significant https://swagger.io/docs/specification/authentication/)",given:["$.security","$.paths..security"],then:{function:U},formats:[_.oas3]},"duplicate-security-and-request-parameters":{description:"Duplicate security and request parameters will cause generated SDKs to have undesired behavior.",message:"Duplicate parameter '{{error}}' in request parameters and security schemes.",given:"#OperationObject",then:{function:re},formats:[_.oas3],severity:h.Error},"operation-operationId":{message:"Operation#operationId is used SDK method and highly recommended to create better SDKs.",given:"#OperationObject",then:{field:"operationId",function:O.truthy}},"redundant-security-schemes":{message:"Remove redundant security schemes from operation object.",given:"#OperationObject",then:{function:ne}},"no-additional-properties":{message:se,given:"#ResponseSchemaObject",then:{function:ie},severity:h.Error},"potential-data-type":{message:"{{error}}. Ensure your types are correct.",given:["#ResponseSchemaObject..","#RequestSchemaObject..","#ParameterSchemaObject.."],then:{function:oe},severity:h.Error},"limited-oas3_1-support":{message:"Konfig has limited support for OAS 3.1",given:"$.openapi",then:{function:O.pattern,functionOptions:{notMatch:"^3.1.\\d$"}},severity:h.Error}}};0&&(module.exports={});
module.exports = module.exports.default;
//# sourceMappingURL=ruleset.js.map