name: Test Publish

on: push

jobs:

  test_publish:
    runs-on: ubuntu-latest
    container:
      image: konfigdev/konfig:latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v3

      - name: Install konfig
        run: npm install -g konfig-cli

      - name: Give docker git permission
        run: git config --global --add safe.directory /__w/acme-sdks/acme-sdks

      - name: Check git status
        run: git status

      - name: Test publish
        run: konfig publish --skipTests -g python,typescript
        env:
          TWINE_USERNAME: "konfig"
